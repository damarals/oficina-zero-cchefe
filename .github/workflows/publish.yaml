name: Quarto Publish

on:
  workflow_dispatch:
  push:
    branches: [main]

jobs:

  build-and-convert:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v4

    - name: Install Chromium
      run: |
        sudo apt-get update
        sudo apt-get install -y chromium-browser

    - name: Set up Quarto
      uses: quarto-dev/quarto-actions/setup@v2
        
    - name: Render to HTML and convert to PDF
      run: |
        quarto render '0. oficina-zero/wsl.qmd'
        chromium --headless --print-to-pdf='0. oficina-zero/wsl.pdf' '0. oficina-zero/wsl.html'
        git add '0. oficina-zero/wsl.pdf'
      
    - name: Commit and push PDFs
      run: |
        git config user.name github-actions
        git config user.email github-actions@github.com
        git commit -m "Add generated PDFs"
        git push